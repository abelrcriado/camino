# Endpoints para Migrar a asyncHandler
# Generado: Sun Oct 12 17:13:58 CEST 2025
# Sprint 6.1

## Total: 82 archivos

- [ ] pages/api/webhook/stripe.ts
- [ ] pages/api/vending-machines/[id].ts
- [ ] pages/api/vending-machines/index.ts
- [ ] pages/api/workshops/[id].ts
- [ ] pages/api/workshops/index.ts
- [ ] pages/api/subcategories/[id].ts
- [ ] pages/api/subcategories/index.ts
- [ ] pages/api/report.ts
- [ ] pages/api/payments/confirm.ts
- [ ] pages/api/payments/refund.ts
- [ ] pages/api/payments/stats.ts
- [ ] pages/api/payments/[id].ts
- [ ] pages/api/payments/cancel.ts
- [ ] pages/api/payments/index.ts
- [ ] pages/api/warehouses/[id].ts
- [ ] pages/api/warehouses/index.ts
- [ ] pages/api/products/brands.ts
- [ ] pages/api/products/[id].ts
- [ ] pages/api/products/sku/[sku].ts
- [ ] pages/api/products/index.ts
- [ ] pages/api/products/tags.ts
- [ ] pages/api/bookings/index.ts
- [ ] pages/api/bookings/[id]/reschedule.ts
- [ ] pages/api/bookings/[id]/cancel.ts
- [ ] pages/api/bookings/[id]/approve.ts
- [ ] pages/api/service-types/[id].ts
- [ ] pages/api/service-types/index.ts
- [ ] pages/api/network/configuration.ts
- [ ] pages/api/margins/[id].ts
- [ ] pages/api/margins/[id]/products.ts
- [ ] pages/api/service-assignments.ts
- [ ] pages/api/service-points/stats.ts
- [ ] pages/api/service-points/[id].ts
- [ ] pages/api/service-points/index.ts
- [ ] pages/api/service-points/[id]/revenue.ts
- [ ] pages/api/vending-machine-slots.ts
- [ ] pages/api/locations/[id].ts
- [ ] pages/api/locations/index.ts
- [ ] pages/api/vending-machine-slots/create-for-machine.ts
- [ ] pages/api/vending-machine-slots/stock-operations.ts
- [ ] pages/api/vending-machine-slots/assign-product.ts
- [ ] pages/api/geolocation/[...path].ts
- [ ] pages/api/users/[id].ts
- [ ] pages/api/users/index.ts
- [ ] pages/api/stock-requests/in-transit.ts
- [ ] pages/api/stock-requests/stats.ts
- [ ] pages/api/stock-requests/[id].ts
- [ ] pages/api/stock-requests/index.ts
- [ ] pages/api/stock-requests/[id]/prepare.ts
- [ ] pages/api/stock-requests/[id]/deliver.ts
- [ ] pages/api/stock-requests/[id]/ship.ts
- [ ] pages/api/stock-requests/[id]/cancel.ts
- [ ] pages/api/stock-requests/[id]/consolidate.ts
- [ ] pages/api/stock-requests/requiring-action.ts
- [ ] pages/api/productos.ts
- [ ] pages/api/productos/categorias.ts
- [ ] pages/api/productos/marcas.ts
- [ ] pages/api/precios.ts
- [ ] pages/api/categories/reorder.ts
- [ ] pages/api/categories/[id].ts
- [ ] pages/api/categories/index.ts
- [ ] pages/api/services/[id].ts
- [ ] pages/api/services/by-status.ts
- [ ] pages/api/services/needing-maintenance.ts
- [ ] pages/api/services/index.ts
- [ ] pages/api/services/[id]/schedule-maintenance.ts
- [ ] pages/api/services/[id]/status.ts
- [ ] pages/api/services/[id]/usage.ts
- [ ] pages/api/services/[id]/complete-maintenance.ts
- [ ] pages/api/service-assignments/unassign.ts
- [ ] pages/api/service-assignments/[id].ts
- [ ] pages/api/service-assignments/index.ts
- [ ] pages/api/warehouse-inventory/locations.ts
- [ ] pages/api/warehouse-inventory/low-stock.ts
- [ ] pages/api/warehouse-inventory/value.ts
- [ ] pages/api/warehouse-inventory/summary.ts
- [ ] pages/api/warehouse-inventory/transfer.ts
- [ ] pages/api/warehouse-inventory/product/[id].ts
- [ ] pages/api/warehouse-inventory/purchase.ts
- [ ] pages/api/warehouse-inventory/adjust.ts
- [ ] pages/api/warehouse-inventory/warehouse/[id].ts
- [ ] pages/api/warehouse-inventory/movements.ts

## Pattern de Migración

### ANTES:
```typescript
import { handleError } from '@/middlewares/error-handler';

export default async function handler(req: NextApiRequest, res: NextApiResponse) {
  try {
    // lógica del endpoint
    return res.status(200).json({ data: result });
  } catch (error) {
    return handleError(error, res);
  }
}
```

### DESPUÉS:
```typescript
import { asyncHandler } from '@/middlewares/error-handler';

export default asyncHandler(async (req, res) => {
  // lógica del endpoint (sin try/catch)
  return res.status(200).json({ data: result });
});
```

## Validación

Después de cada migración:
1. `npm test` - Verificar tests pasan
2. `npm run lint` - Verificar lint pasa
3. Si fallan tests, revertir desde backups/

## Backups

Ubicación: backups/async-handler-migration-20251012_171358/
